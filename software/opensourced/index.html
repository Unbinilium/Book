<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Open Sourced | Unbinilium&#39;s 📖</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="manifest" href="/manifest.json" crossorigin="use-credentials">
    <link rel="shortcut icon" type="image/png" href="/favicon.png">
    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png">
    <meta name="description" content="Unbinilium's personal knowledge book">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no,viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="msapplication-TileColor" content="#fff">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon.png">
    <meta property="og:title" content="Unbinilium's 📖">
    <meta property="og:description" content="Unbinilium's personal knowledge book">
    <meta property="og:url" content="https://xn--vt8h.unbinilium.me/">
    <meta property="og:image" content="https://xn--vt8h.unbinilium.me/open_graph_logo.png">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Unbinilium's 📖">
    
    <link rel="preload" href="/assets/css/0.styles.c86a7820.css" as="style"><link rel="preload" href="/assets/js/app.041ccf91.js" as="script"><link rel="preload" href="/assets/js/2.30d40f56.js" as="script"><link rel="preload" href="/assets/js/28.30ebeba7.js" as="script"><link rel="preload" href="/assets/js/3.9032db0e.js" as="script"><link rel="prefetch" href="/assets/js/10.469d6b72.js"><link rel="prefetch" href="/assets/js/11.c6524284.js"><link rel="prefetch" href="/assets/js/12.ce88ebf9.js"><link rel="prefetch" href="/assets/js/13.ab2b84d3.js"><link rel="prefetch" href="/assets/js/14.fe038601.js"><link rel="prefetch" href="/assets/js/15.a0555c26.js"><link rel="prefetch" href="/assets/js/16.f55579dd.js"><link rel="prefetch" href="/assets/js/17.ebad19b1.js"><link rel="prefetch" href="/assets/js/18.fadf84da.js"><link rel="prefetch" href="/assets/js/19.43a71af3.js"><link rel="prefetch" href="/assets/js/20.946ff141.js"><link rel="prefetch" href="/assets/js/21.811b4ca6.js"><link rel="prefetch" href="/assets/js/22.4d4a6949.js"><link rel="prefetch" href="/assets/js/23.db0b25e6.js"><link rel="prefetch" href="/assets/js/24.63f564f1.js"><link rel="prefetch" href="/assets/js/25.ef3461c4.js"><link rel="prefetch" href="/assets/js/26.6354f890.js"><link rel="prefetch" href="/assets/js/27.1b44817a.js"><link rel="prefetch" href="/assets/js/29.fd0c526c.js"><link rel="prefetch" href="/assets/js/30.3294a55b.js"><link rel="prefetch" href="/assets/js/4.5e92b263.js"><link rel="prefetch" href="/assets/js/5.665901b5.js"><link rel="prefetch" href="/assets/js/6.6ba3b61b.js"><link rel="prefetch" href="/assets/js/7.d31a3cd7.js"><link rel="prefetch" href="/assets/js/8.d4661bf2.js"><link rel="prefetch" href="/assets/js/9.168171d4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c86a7820.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Unbinilium's 📖</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link router-link-active">
  Book
</a></div><div class="nav-item"><a href="https://unbinilium.me/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  About
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link router-link-active">
  Book
</a></div><div class="nav-item"><a href="https://unbinilium.me/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  About
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Coding</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Programming</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Security</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Software</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/software/ide/" class="sidebar-link">IDE</a></li><li><a href="/software/opensourced/" aria-current="page" class="active sidebar-link">Open Sourced</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/software/opensourced/#build-shadowsocks" class="sidebar-link">Build Shadowsocks</a></li><li class="sidebar-sub-header"><a href="/software/opensourced/#build-pytorch" class="sidebar-link">Build PyTorch</a></li><li class="sidebar-sub-header"><a href="/software/opensourced/#build-opencv" class="sidebar-link">Build OpenCV</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/software/opensourced/#install-dependencies" class="sidebar-link">Install dependencies</a></li><li class="sidebar-sub-header"><a href="/software/opensourced/#custom-configuration" class="sidebar-link">Custom configuration</a></li><li class="sidebar-sub-header"><a href="/software/opensourced/#download-sources" class="sidebar-link">Download sources</a></li><li class="sidebar-sub-header"><a href="/software/opensourced/#optimized-compiling" class="sidebar-link">Optimized compiling</a></li><li class="sidebar-sub-header"><a href="/software/opensourced/#compile-and-test" class="sidebar-link">Compile and Test</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Design</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Writing</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Collection</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>See Also</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="build-shadowsocks"><a href="#build-shadowsocks" class="header-anchor">#</a> Build Shadowsocks</h2> <p>With no time updating <a href="https://unbinilium.github.io/Twist" target="_blank" rel="noopener noreferrer">Twist<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, I wrote this extremely simple script to setup shadowsocks-libev both server and client.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">apt-get</span> update -y
<span class="token function">apt-get</span> upgrade -y
<span class="token function">apt-get</span> dist-upgrade -y
<span class="token function">apt-get</span> autoremove -y
<span class="token function">apt-get</span> <span class="token function">install</span> --no-install-recommends -y gettext build-essential autoconf libtool libpcre3-dev asciidoc xmlto libev-dev libc-ares-dev automake golang golang-go fail2ban apache2 <span class="token function">unzip</span> <span class="token function">git</span>
<span class="token function">git</span> clone https://github.com/jedisct1/libsodium --branch master
<span class="token function">pushd</span> libsodium
<span class="token function">bash</span> autogen.sh
./configure --prefix<span class="token operator">=</span>/usr
<span class="token function">make</span>
<span class="token function">make</span> <span class="token function">install</span>
ldconfig
<span class="token function">popd</span>
<span class="token assign-left variable">mbedtlsver</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token function">wget</span> -qO- https://tls.mbed.org/download-archive <span class="token operator">|</span> <span class="token function">grep</span> -oE <span class="token string">'[0-9]+\.[0-9]+\.[0-9]+'</span> <span class="token operator">|</span> <span class="token function">cut</span> -d<span class="token string">'.'</span> -f1,2,3 <span class="token operator">|</span> <span class="token function">sort</span> -V <span class="token operator">|</span> <span class="token function">tail</span> -1<span class="token variable">)</span></span>&quot;</span>
<span class="token function">wget</span> -t <span class="token number">3</span> -T <span class="token number">30</span> -nv -O mbedtls-<span class="token variable">${mbedtlsver}</span>-gpl.tgz https://tls.mbed.org/download/mbedtls-<span class="token variable">${mbedtlsver}</span>-gpl.tgz
<span class="token function">tar</span> xf mbedtls-<span class="token variable">${mbedtlsver}</span>-gpl.tgz
<span class="token function">pushd</span> mbedtls-<span class="token variable">${mbedtlsver}</span>
<span class="token function">make</span> <span class="token assign-left variable">SHARED</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">CFLAGS</span><span class="token operator">=</span>-fPIC
<span class="token function">make</span> <span class="token assign-left variable">DESTDIR</span><span class="token operator">=</span>/usr <span class="token function">install</span>
ldconfig
<span class="token function">popd</span>
<span class="token function">git</span> clone https://github.com/shadowsocks/shadowsocks-libev.git
<span class="token function">pushd</span> shadowsocks-libev
<span class="token function">git</span> submodule update --init --recursive
<span class="token function">bash</span> autogen.sh
./configure --disable-documentation
<span class="token function">make</span>
<span class="token function">make</span> <span class="token function">install</span>
ldconfig
<span class="token function">popd</span>
<span class="token function">git</span> clone https://github.com/shadowsocks/simple-obfs.git
<span class="token function">pushd</span> simple-obfs
<span class="token function">git</span> submodule update --init --recursive
./autogen.sh
./configure
<span class="token function">make</span>
<span class="token function">make</span> <span class="token function">install</span>
ldconfig
<span class="token function">popd</span>
<span class="token function">git</span> clone https://github.com/shadowsocks/v2ray-plugin.git
<span class="token function">pushd</span> v2ray-plugin
go get
go build
ldconfig
<span class="token function">popd</span>
<span class="token function">rm</span> -fr libsodium mbedtls-<span class="token variable">${mbedtlsver}</span>-gpl.tgz mbedtls-<span class="token variable">${mbedtlsver}</span> shadowsocks-libev simple-obfs v2ray-plugin
<span class="token function">sleep</span> <span class="token number">3</span>
<span class="token function">reboot</span>
</code></pre></div><p>Server-side configuration should be like this before replaced by customized configuration. It stored in <code>/etc/shadowsocks-libev/config.json</code> by default, we can o edit it by command:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">nano</span> /etc/shadowsocks-libev/config.json
</code></pre></div><p>Editing it like this:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;server&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;0.0.0.0&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;[::0]&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;server_port&quot;</span><span class="token operator">:</span>serverport<span class="token punctuation">,</span>
    <span class="token property">&quot;password&quot;</span><span class="token operator">:</span><span class="token string">&quot;serverpassword&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;method&quot;</span><span class="token operator">:</span><span class="token string">&quot;encryptmethod&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timeout&quot;</span><span class="token operator">:</span><span class="token number">7200</span><span class="token punctuation">,</span>
    <span class="token property">&quot;udp_timeout&quot;</span><span class="token operator">:</span><span class="token number">7200</span><span class="token punctuation">,</span>
    <span class="token property">&quot;fast_open&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;reuse_port&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;plugin&quot;</span><span class="token operator">:</span><span class="token string">&quot;obfs-server&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;plugin_opts&quot;</span><span class="token operator">:</span><span class="token string">&quot;obfs=tls;fast-open;failover=obfshost:serverport&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;nofile&quot;</span><span class="token operator">:</span><span class="token number">512000</span><span class="token punctuation">,</span>
    <span class="token property">&quot;nameserver&quot;</span><span class="token operator">:</span><span class="token string">&quot;nameserver1,nameserver2&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;dscp&quot;</span><span class="token operator">:</span><span class="token string">&quot;EF&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;mode&quot;</span><span class="token operator">:</span><span class="token string">&quot;tcp_and_udp&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;mptcp&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;ipv6_first&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;no_delay&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This would be client configuration example which is always stored in <code>/etc/shadowsocks-libev/config.json</code> and you edit it using the same command:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">nano</span> /etc/shadowsocks-libev/config.json
</code></pre></div><p>It necessary to replace all the information which matches to your server-side configuration.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;local_port&quot;</span><span class="token operator">:</span><span class="token string">&quot;localport&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;server&quot;</span><span class="token operator">:</span><span class="token string">&quot;serverhost&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;fast_open&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;reuse_port&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;nameserver&quot;</span><span class="token operator">:</span><span class="token string">&quot;nameserver1,nameserver2&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;mode&quot;</span><span class="token operator">:</span><span class="token string">&quot;tcp_and_udp&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;no_delay&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;server_port&quot;</span><span class="token operator">:</span>serverport<span class="token punctuation">,</span>
    <span class="token property">&quot;password&quot;</span><span class="token operator">:</span><span class="token string">&quot;serverpassword&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;method&quot;</span><span class="token operator">:</span><span class="token string">&quot;encryptmethod&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;plugin&quot;</span><span class="token operator">:</span><span class="token string">&quot;obfs-local&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;plugin_opts&quot;</span><span class="token operator">:</span><span class="token string">&quot;obfs=tls;fast-open;obfs-host=obfshost&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timeout&quot;</span><span class="token operator">:</span><span class="token number">5</span>
<span class="token punctuation">}</span>
</code></pre></div><p>To start server, it's better to use command <code>systemctl</code>:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>systemctl <span class="token builtin class-name">enable</span> shadowsocks-libev
systemctl start shadowsocks-libev
</code></pre></div><p>And this will set shadowsocks-libev to start while starting system.</p> <p>Staring shadowsocks-libev client is a little different from starting server. Firstly the configuration file should be change by editing it using command:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">nano</span> /etc/systemd/system/shadowsocks-libev.service
</code></pre></div><p>Then replace the line matches <code>ExecStart=</code> with:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/bin/ss-local -c <span class="token variable">$CONFFILE</span> <span class="token variable">$DAEMON_ARGS</span>
</code></pre></div><p>Last use the same command as starting server to start shadowsocks-libev client.</p> <p>You can also monitor the status of your server both client by <code>systemctl status shadowsocks-libev</code> and for shadowsocks-libev client it shows like this as <code>ss-local</code>:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>shadowsocks-libev.service - Shadowsocks-libev Default Server Service
   Loaded: loaded <span class="token punctuation">(</span>/etc/systemd/system/shadowsocks-libev.service<span class="token punctuation">;</span> enabled<span class="token punctuation">;</span> vendor preset: enabled<span class="token punctuation">)</span>
   Active: active <span class="token punctuation">(</span>running<span class="token punctuation">)</span> since Tue <span class="token number">2019</span>-10-29 09:20:31 CST<span class="token punctuation">;</span> 4h 54min ago
     Docs: man:shadowsocks-libev<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
 Main PID: <span class="token number">890</span> <span class="token punctuation">(</span>ss-local<span class="token punctuation">)</span>
    Tasks: <span class="token number">2</span> <span class="token punctuation">(</span>limit: <span class="token number">9442</span><span class="token punctuation">)</span>
   CGroup: /system.slice/shadowsocks-libev.service
           ├─890 /usr/bin/ss-local -c /etc/shadowsocks-libev/config.json -u
           └─933 obfs-local
</code></pre></div><h2 id="build-pytorch"><a href="#build-pytorch" class="header-anchor">#</a> Build PyTorch</h2> <ul><li><p>Install dependencies</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> -y libopenblas-dev libblas-dev m4 cmake cython python3-dev python3-yaml python3-setuptools libavutil-dev libavcodec-dev libavformat-dev libswscale-dev
</code></pre></div></li> <li><p>Build PyTorch from the source</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> clone --recursive https://github.com/pytorch/pytorch
<span class="token function">pushd</span> pytorch
<span class="token function">git</span> submodule update --remote third_party/protobuf
python3 setup.py build
<span class="token function">sudo</span> python3 setup.py <span class="token function">install</span>
</code></pre></div></li> <li><p>Build PyTorch Vision from the source</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> clone --recursive https://github.com/pytorch/vision
<span class="token builtin class-name">cd</span> vision
python3 setup.py build
<span class="token function">sudo</span> python3 setup.py <span class="token function">install</span>
</code></pre></div></li></ul> <h2 id="build-opencv"><a href="#build-opencv" class="header-anchor">#</a> Build OpenCV</h2> <p><strong>OpenCV</strong> (<em>Open Source Computer Vision Library</em>) is a <a href="https://en.wikipedia.org/wiki/Library_(computing)" target="_blank" rel="noopener noreferrer">library of programming functions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> mainly aimed at real-time <a href="https://en.wikipedia.org/wiki/Computer_vision" target="_blank" rel="noopener noreferrer">computer vision<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Here I introduced some ways to compile OpenCV with Contrib for different devices like <strong>Jetson TX2</strong>, <strong>Raspberry Pi 4B</strong> and <strong>x86_64 PC</strong>.</p> <h3 id="install-dependencies"><a href="#install-dependencies" class="header-anchor">#</a> Install dependencies</h3> <ul><li><p>Update source and upgrade packages, clean and remove unused packages</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">apt</span> update
<span class="token function">sudo</span> <span class="token function">apt</span> upgrade -y
<span class="token function">sudo</span> <span class="token function">apt</span> clean
<span class="token function">sudo</span> <span class="token function">apt</span> autoremove -y
</code></pre></div></li> <li><p>Install <code>python3</code> , <code>pip3</code> and necessary wheels for Python support</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> python3-dev python3-pip -y
<span class="token function">sudo</span> pip3 <span class="token function">install</span> cython setuptools numpy
</code></pre></div></li> <li><p>Install third-party software libraries that require to build</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> gcc-arm* build-essential cmake <span class="token function">git</span> <span class="token function">unzip</span> pkg-config -y
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> protobuf-compiler libgflags-dev libgoogle-glog-dev -y
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> libjpeg-dev libpng-dev libtiff-dev -y
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> libavcodec-dev libavformat-dev libavutil-dev libxvidcore-dev libswscale-dev libx264-dev -y
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> liblapack-dev libxine2-dev gfortran -y
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> libpostproc-dev libswscale-dev -y
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> libmpikmeans-dev libmpikmeans1 mpi-default-dev -y
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> libgtk-3-dev -y
</code></pre></div><p>For a special package called <code>libjasper-dev</code>, which only available before <em>Ubuntu Xenial</em>, we add Xenial sources(Here for Ubuntu restricted systems, we could use <em>Tsinghua mirrors</em>)</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ xenial main multiverse restricted universe&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/apt/sources.list
<span class="token function">sudo</span> <span class="token function">apt</span> update
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> libjasper-dev -y
</code></pre></div></li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Reboot recommended.</p></div> <h3 id="custom-configuration"><a href="#custom-configuration" class="header-anchor">#</a> Custom configuration</h3> <p>For different hardwares, it's better to compile acceleration enabled OpenCV.</p> <h4 id="gpu-with-cuda"><a href="#gpu-with-cuda" class="header-anchor">#</a> GPU with CUDA</h4> <p>Like Jetson TX2, which hardware has standalone GPU support, that we could enable GPU acceleration by add its CUDA libs while compiling.</p> <ul><li><p>Install CUDA from <code>dpkg</code></p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> dpkg -i <span class="token operator">&lt;</span>CUDA deb path<span class="token operator">&gt;</span>
<span class="token function">sudo</span> dpkg -i <span class="token operator">&lt;</span>CuDnn deb path<span class="token operator">&gt;</span>
<span class="token function">sudo</span> dpkg -i <span class="token operator">&lt;</span>NightSystems deb path<span class="token operator">&gt;</span>
</code></pre></div></li> <li><p>Confirm installation using apt</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">apt</span> search cuda
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token operator">&lt;</span>CUDA name<span class="token operator">&gt;</span>

<span class="token function">apt</span> search cudnn
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token operator">&lt;</span>CuDnn name<span class="token operator">&gt;</span>

<span class="token function">apt</span> search NightSystems
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token operator">&lt;</span>NightSystems<span class="token operator">&gt;</span>
</code></pre></div></li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Reboot recommended.</p></div> <h4 id="low-memory-devices"><a href="#low-memory-devices" class="header-anchor">#</a> Low-memory devices</h4> <p>For the devices which has small RAM size like Raspberry Pi 4B (2G), it's recommended that to use large swap.</p> <ul><li><p>Create 2G or larger blank file to disk</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> fallocate -l 2G /swapfile
</code></pre></div></li> <li><p>Protect memory, only the root user should be able to write and read the swap file</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">chmod</span> <span class="token number">600</span> /swapfile
</code></pre></div></li> <li><p>Use the <code>mkswap</code> utility to set up the file as Linux swap area</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">mkswap</span> /swapfile
</code></pre></div></li> <li><p>Enable the swap and verify</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">swapon</span> /swapfile
<span class="token function">sudo</span> <span class="token function">swapon</span> --show
</code></pre></div><p>To make the change permanent open the <code>/etc/fstab</code> file and append the following line by this command</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;/swapfile swap swap defaults 0 0&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/fstab
</code></pre></div></li></ul> <p>Furthermore, you could custom the swappiness value. Swappiness is a Linux kernel property that defines how often the system will use the swap space. Swappiness can have a value between 0 and 100. A low value will make the kernel to try to avoid swapping whenever possible, while a higher value will make the kernel to use the swap space more aggressively.</p> <ul><li><p>Set your <em>swappiness</em>, the default is <em>60</em></p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> sysctl vm.swappiness<span class="token operator">=</span><span class="token number">60</span>
</code></pre></div></li></ul> <p>To remove swap file, deactivate the swap and delete swapfile</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> swapoff -v /swapfile
<span class="token function">sudo</span> <span class="token function">sed</span> -i ‘/swapfile/d’ /etc/fstab
<span class="token function">sudo</span> <span class="token function">rm</span> /swapfile
</code></pre></div><h4 id="gstreamer"><a href="#gstreamer" class="header-anchor">#</a> Gstreamer</h4> <p>GStreamer is a library for constructing graphs of media-handling components. The applications it supports range from simple Ogg/Vorbis playback, audio/video streaming to complex audio (mixing) and video (non-linear editing) processing.</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> libgstreamer1.0-dev libgstreamer-plugins-base1.0-dev -y
</code></pre></div><h4 id="threading-building-blocks"><a href="#threading-building-blocks" class="header-anchor">#</a> Threading building blocks</h4> <p>Threading Building Blocks (Intel^®^ TBB) makes parallel performance and scalability accessible to software developers who are writing loop- and task-based applications. Build robust applications that abstract platform details and threading mechanisms while achieving performance that scales with increasing core count.</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> libtbb2 libtbb-dev -y
</code></pre></div><h4 id="handing-medias"><a href="#handing-medias" class="header-anchor">#</a> Handing medias</h4> <p>The <em>v4l-utils</em> are a series of packages for handling media devices, <em>libdc1394</em> is a library that provides a complete high level application programming interface (API) for developers who wish to control IEEE 1394 based cameras that conform to the 1394-based Digital Camera Specifications (also known as the IIDC or DCAM Specifications).</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> v4l-utils libv4l-dev libdc1394-22-dev -y
</code></pre></div><h4 id="blas"><a href="#blas" class="header-anchor">#</a> BLAS</h4> <p>BLAS (Basic Linear Algebra Subroutines) is a set of efficient routines for most of the basic vector and matrix operations. They are widely used as the basis for other high quality linear algebra software, for example lapack and linpack.</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> libopenblas-dev libatlas-base-dev libblas-dev -y
</code></pre></div><h4 id="qt5"><a href="#qt5" class="header-anchor">#</a> QT5</h4> <p>Qt is a cross-platform C++ application framework. Qt's primary feature is its rich set of widgets that provide standard GUI functionality.</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> qt5-default -y
</code></pre></div><h4 id="hdf5"><a href="#hdf5" class="header-anchor">#</a> HDF5</h4> <p><strong>Hierarchical Data Format</strong> (<strong>HDF</strong>) is a set of file formats (<strong>HDF4</strong>, <strong>HDF5</strong>) designed to store and organize large amounts of data.</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> libhdf5-serial-dev hdf5-tools libhdf5-dev -y
</code></pre></div><h4 id="tesseract"><a href="#tesseract" class="header-anchor">#</a> Tesseract</h4> <p>Tesseract is an open source Optical Character Recognition (OCR) Engine. It can be used directly, or (for programmers) using an API to extract printed text from images. It supports a wide variety of languages.</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> libtesseract-dev tesseract-ocr -y
</code></pre></div><h4 id="eigen"><a href="#eigen" class="header-anchor">#</a> Eigen</h4> <p>Eigen is a versatile, fast, reliable and elegant C++ template library for linear algebra: matrices, vectors, numerical solvers, and related algorithms.</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> libeigen3-dev -y
</code></pre></div><h3 id="download-sources"><a href="#download-sources" class="header-anchor">#</a> Download sources</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><a href="https://github.com/opencv/opencv/releases" target="_blank" rel="noopener noreferrer">OpenCV Release - GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://github.com/opencv/opencv_contrib/releases" target="_blank" rel="noopener noreferrer">OpenCV Contrib Release - GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <ul><li><p>Source code can be founded on GitHub, then we download it.</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">pushd</span> /tmp

<span class="token function">wget</span> -O opencv.zip https://github.com/opencv/opencv/archive/4.5.0.zip
<span class="token function">wget</span> -O opencv_contrib.zip https://github.com/opencv/opencv_contrib/archive/4.5.0.zip
</code></pre></div></li> <li><p>Unzip source and enter OpenCV source, create build folder.</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">unzip</span> opencv.zip opencv_contrib.zip
<span class="token function">pushd</span> opencv-*.*.*
<span class="token function">mkdir</span> build
<span class="token function">pushd</span> build
</code></pre></div></li></ul> <h3 id="optimized-compiling"><a href="#optimized-compiling" class="header-anchor">#</a> Optimized compiling</h3> <p>CMake is a cross-platform build system generator. Projects specify their build process with platform-independent CMake listfiles included in each directory of a source tree with the name CMakeLists.txt. Users build a project by using CMake to generate a build system for a native tool on their platform.</p> <p>Here I compile OpenCV with OpenCV Contrib by default:</p> <div class="language-shell extra-class"><pre class="language-shell"><code>cmake -D <span class="token assign-left variable">CMAKE_BUILD_TYPE</span><span class="token operator">=</span>RELEASE <span class="token punctuation">\</span>
      -D <span class="token assign-left variable">OPENCV_EXTRA_MODULES_PATH</span><span class="token operator">=</span><span class="token punctuation">..</span>/<span class="token punctuation">..</span>/opencv_contrib-*.*.*/modules <span class="token punctuation">\</span>
      -D <span class="token assign-left variable">WITH_OPENMP</span><span class="token operator">=</span>ON <span class="token punctuation">\</span>
      -D <span class="token assign-left variable">WITH_TBB</span><span class="token operator">=</span>ON <span class="token punctuation">\</span>
      -D <span class="token assign-left variable">BUILD_TBB</span><span class="token operator">=</span>ON <span class="token punctuation">\</span>
      -D <span class="token assign-left variable">BUILD_TIFF</span><span class="token operator">=</span>ON <span class="token punctuation">\</span>
      -D <span class="token assign-left variable">WITH_GSTREAMER</span><span class="token operator">=</span>ON <span class="token punctuation">\</span>
      -D <span class="token assign-left variable">WITH_V4L</span><span class="token operator">=</span>ON <span class="token punctuation">\</span>
      -D <span class="token assign-left variable">WITH_LIBV4L</span><span class="token operator">=</span>ON <span class="token punctuation">\</span>
      -D <span class="token assign-left variable">OPENCV_ENABLE_NONFREE</span><span class="token operator">=</span>ON <span class="token punctuation">\</span>
      -D <span class="token assign-left variable">INSTALL_C_EXAMPLES</span><span class="token operator">=</span>OFF <span class="token punctuation">\</span>
      -D <span class="token assign-left variable">INSTALL_PYTHON_EXAMPLES</span><span class="token operator">=</span>OFF <span class="token punctuation">\</span>
      -D <span class="token assign-left variable">BUILD_NEW_PYTHON_SUPPORT</span><span class="token operator">=</span>ON <span class="token punctuation">\</span>
      -D <span class="token assign-left variable">BUILD_opencv_python3</span><span class="token operator">=</span>TRUE <span class="token punctuation">\</span>
      -D <span class="token assign-left variable">WITH_QT</span><span class="token operator">=</span>ON <span class="token punctuation">\</span>
      -D <span class="token assign-left variable">BUILD_EXAMPLES</span><span class="token operator">=</span>OFF <span class="token punctuation">\</span>
      <span class="token punctuation">..</span>
</code></pre></div><h4 id="arch"><a href="#arch" class="header-anchor">#</a> Arch</h4> <p>While the devices has both AArch (ARMv8) CPU and software environment (64bit kernel and 64bit compiler), such as Jetson TX2, Raspberry Pi 4B with 64bit OS, there would be something different for CMake flags.</p> <ul><li><p>AArch32</p> <div class="language-shell extra-class"><pre class="language-shell"><code>-D <span class="token assign-left variable">ENABLE_NEON</span><span class="token operator">=</span>ON <span class="token punctuation">\</span>
-D <span class="token assign-left variable">ENABLE_VFPV3</span><span class="token operator">=</span>ON <span class="token punctuation">\</span>
</code></pre></div></li> <li><p>AArch64</p> <div class="language-shell extra-class"><pre class="language-shell"><code>-D <span class="token assign-left variable">ENABLE_NEON</span><span class="token operator">=</span>ON <span class="token punctuation">\</span>
</code></pre></div></li></ul> <h4 id="gpu"><a href="#gpu" class="header-anchor">#</a> GPU</h4> <p>We have noticed that in most scenarios OpenCV utilizes CPU, which doesn’t always guarantee our the desired performance.</p> <ul><li><p>CUDA</p> <div class="language-shell extra-class"><pre class="language-shell"><code>-D <span class="token assign-left variable">WITH_CUDA</span><span class="token operator">=</span>ON <span class="token punctuation">\</span>
-D <span class="token assign-left variable">WITH_CUBLAS</span><span class="token operator">=</span>ON <span class="token punctuation">\</span>
-D <span class="token assign-left variable">CUDA_FAST_MATH</span><span class="token operator">=</span>ON <span class="token punctuation">\</span>
-D <span class="token assign-left variable">ENABLE_FAST_MATH</span><span class="token operator">=</span>ON <span class="token punctuation">\</span>
-D <span class="token assign-left variable">WITH_OPENGL</span><span class="token operator">=</span>ON <span class="token punctuation">\</span>
</code></pre></div></li></ul> <h4 id="java-api"><a href="#java-api" class="header-anchor">#</a> Java API</h4> <p>Build OpenCV Java API requires Java runtime, make sure <em>jdk</em> is installed first, and then <strong>reconfigure</strong> CMake flags.</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> openjdk-11-jdk ant -y
</code></pre></div><p><em>Note: Compile OpenCV with Contrib may require unblocked Internet connection.</em></p> <h3 id="compile-and-test"><a href="#compile-and-test" class="header-anchor">#</a> Compile and Test</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><a href="https://book.unbinilium.me/linux/optmization/#cmake-multi-cores" target="_blank" rel="noopener noreferrer">CMake multi-cores<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <p>Finally we got this command which makes the build process much faster.</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">make</span> -j <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> -c ^processor /proc/cpuinfo<span class="token variable">)</span></span>&quot;</span>
</code></pre></div><p>If there’s no errors displayed, it means you compiled OpenCV successfully. Then, we install and linking.</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">make</span> <span class="token function">install</span>
<span class="token function">sudo</span> ldconfig
</code></pre></div><p>For Jetson TX2, Here's an example to test onboard camera and if Gstreamer works.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;opencv2/core.hpp&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;opencv2/videoio.hpp&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;opencv2/highgui.hpp&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> cv<span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Mat frame<span class="token punctuation">;</span>
    VideoCapture cap<span class="token punctuation">;</span>

    cap<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;nvarguscamerasrc ! video/x-raw(memory:NVMM), width=(int)720, height=(int)480, format=(string)NV12, framerate=(fraction)30/1 ! nvvidconv ! video/x-raw, format=BGRx ! videoconvert ! video/x-raw, format=BGR ! appsink&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cap<span class="token punctuation">.</span><span class="token function">isOpened</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cap<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>frame<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>frame<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>

        <span class="token function">imshow</span><span class="token punctuation">(</span><span class="token string">&quot;frame&quot;</span><span class="token punctuation">,</span> frame<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">waitKey</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">CC BY-SA 4.0 / Last Updated:</span> <span class="time">1/28/2021, 9:54:53 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/software/ide/" class="prev">
        IDE
      </a></span> <span class="next"><a href="/linux/command/">
        Command
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.041ccf91.js" defer></script><script src="/assets/js/2.30d40f56.js" defer></script><script src="/assets/js/28.30ebeba7.js" defer></script><script src="/assets/js/3.9032db0e.js" defer></script>
  </body>
</html>
